get:
  x-internal: true
  summary: Search entities
  description: Search entities
  security:
    - OAuth2: ['ROLE_OPR_MGR', 'ROLE_OPR_ANS', 'ROLE_SYS_MGR', 'ROLE_SYS_ANS', 'ROLE_ENT_ADMIN']
  tags:
    - Entities
  parameters:
    - in: header
      name: Authorization
      description: Bearer Token
      schema:
        type: string
      required: true
    - in: query
      name: operator_id
      description: The operator of the entity
      schema:
        type: integer
    - in: query
      name: type
      description: The type of the entity
      schema:
        $ref: ../../models/entities/entity-type.yml
    - in: query
      name: allow_avet_integration
      x-internal: true
      description: Whether or not the entity allow integration with AVET
      schema:
        type: boolean
    - in: query
      name: allow_members
      x-internal: true
      description: Whether or not the entity allow customers management
      schema:
        type: boolean
    - in: query
      name: allow_digital_season_ticket
      description: Whether or not the entity allows digital season tickets
      schema:
        type: boolean
    - in: query
      name: b2b_enabled
      description: Whether or not B2B channels are enabled in this entity
      schema:
        type: boolean
    - in: query
      name: allow_massive_email
      description: Whether or not the entity allows massive email
      schema:
        type: boolean
    - in: query
      x-internal: true
      name: include_entity_admin
      description: Whether or not the list include entities admin
      schema:
        type: boolean
    - in: query
      x-internal: true
      name: allow_config_multiple_templates
      description: allow configure different pdf templates
      schema:
        type: boolean
    - in: query
      name: status
      description: The status of the entity
      style: form
      schema:
        type: array
        items:
          type: string
          enum:
            - ACTIVE
            - PENDING
            - BLOCKED
            - TEMPORARY_BLOCKED
    - in: query
      name: q
      description: Free search for entities by name
      schema:
        type: string
    - in: query
      name: fields
      description: Response will contain only the id and the selected fields
      style: form
      schema:
        type: array
        items:
          $ref: ../../models/entities/entity-filter-field.yml
    - in: query
      name: sort
      description: Sorting of enum fields with format field:[asc|desc]. For example 'name:desc'
      schema:
        $ref: ../../models/entities/entity-sort-field.yml
    - in: query
      name: limit
      schema:
        type: integer
      description: Limit (default 50, max 1000)
    - in: query
      name: offset
      schema:
        type: integer
      description: Offset (default 0)
  responses:
    '200':
      description: Array of entities
      content:
        application/json:
          schema:
            $ref: ../../models/entities/entities.yml
    '400':
      description: Bad request
      content:
        application/json:
          schema:
            $ref: ../../models/common/error.yml
    '401':
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: ../../models/common/error-auth.yml
    '403':
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: ../../models/common/error.yml
    '404':
      description: Not found
      content:
        application/json:
          schema:
            $ref: ../../models/common/error.yml
    '500':
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: ../../models/common/error.yml
post:
  x-internal: true
  summary: New entity
  description: Creates new entity
  security:
    - OAuth2: ['ROLE_OPR_MGR', 'ROLE_SYS_MGR']
  tags:
    - Entities
  parameters:
    - in: header
      name: Authorization
      description: Bearer Token
      schema:
        type: string
      required: true
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - name
            - short_name
            - social_reason
            - nif
            - email
            - default_language
            - types
            - contact
          properties:
            name:
              type: string
            short_name:
              type: string
            social_reason:
              type: string
            nif:
              type: string
            reference:
              type: string
            email:
              type: string
            default_language:
              type: string
              description: IETF language tag standard
              example: es-ES
            types:
              type: array
              items:
                type: string
                enum:
                  - VENUE_ENTITY
                  - EVENT_ENTITY
                  - CHANNEL_ENTITY
                  - INSURANCER
            external_avet_club_code:
              type: integer
              minimum: -128
              maximum: 127
              description: non-zero numeric club code (only when creating Avet entities).
            tax_mode:
              type: string
              enum:
                - INCLUDED
                - ON_TOP
            contact:
              required:
                - city
                - country
              type: object
              properties:
                city:
                  type: string
                country:
                  required:
                    - code
                  type: object
                  properties:
                    code:
                      type: string
                      description: ISO 3166 codes
                    name:
                      type: string
  responses:
    '201':
      description: Successful response
      content:
        application/json:
          schema:
            type: object
            properties:
              id:
                type: integer
                format: int64
    '400':
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '../../models/common/error.yml'
    '401':
      description: Invalid token
      content:
        application/json:
          schema:
            $ref: '../../models/common/error-auth.yml'
    '403':
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '../../models/common/error.yml'
    '409':
      description: Conflict
      content:
        application/json:
          schema:
            $ref: ../../models/common/error.yml
    '500':
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '../../models/common/error.yml'
