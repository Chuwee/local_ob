<app-form-container *ngIf="(error$ | async) === null" layout="main" [disabled]="!(form?.dirty) || (reqInProgress$ | async)"
    (cancel)="cancel()" (save)="save()" class="overflow-y-auto">
    <form [formGroup]="form">
        <!-- PERSONAL DATA -->
        <mat-expansion-panel expanded togglePosition="before" [formGroupName]="bff.personalData.k">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'BUYERS.PERSONAL_DATA' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <div fxLayout="row wrap" fxLayoutGap.gt-sm="40px">
                <div fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)">
                    <!-- ID CARD TYPE -->
                    <mat-form-field fxFlex="35%" appearance="outline" class="ob-form-field field-with-label ob-form-subfield">
                        <mat-label>{{'BUYERS.ID_CARD_TYPE_LABEL' | translate}}</mat-label>
                        <mat-select [placeholder]="'FORMS.SELECT.PLACE_HOLDER' | translate" aria-label="idCardType"
                            [formControlName]="bff.personalData.idCardType.k">
                            <mat-option *ngFor="let type of docTypes$ | async" [value]="type">{{type}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <!-- ID CARD -->
                    <mat-form-field fxFlex="calc(65% - 20px)" fxFlexOffset="20px" appearance="outline"
                        class="ob-form-field field-with-label">
                        <mat-label>{{'BUYERS.ID_CARD' | translate}}</mat-label>
                        <input matInput type="text" [placeholder]="'BUYERS.ID_CARD' | translate"
                            [formControlName]="bff.personalData.idCardId.k">
                    </mat-form-field>
                </div>
                <div fxShow.gt-sm fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(66% - 40px)"></div>
                <!-- NAME -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'BUYERS.NAME' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'BUYERS.NAME' | translate" [formControlName]="bff.personalData.name.k">
                </mat-form-field>
                <!-- SURNAME -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'BUYERS.SURNAME' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'BUYERS.SURNAME' | translate" [formControlName]="bff.personalData.surname.k">
                </mat-form-field>
                <!-- GENDER -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'BUYERS.GENDER' | translate}}</mat-label>
                    <mat-select [formControlName]="bff.personalData.gender.k" [placeholder]="'FORMS.SELECT.PLACE_HOLDER' | translate">
                        <mat-option *ngFor="let gender of buyerGenders" [value]="gender">
                            {{'ENUMS.GENDER_OPTS.' + gender | translate}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <!-- TYPE -->
                 <div fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)">
                    <span class="mat-subtitle-2">{{'BUYERS.TYPE' | translate}}</span>
                    <mat-form-field hidden-outline  
                        class="ob-form-field field-with-label">
                        <input matInput fxHide type="text" [formControlName]="bff.personalData.type.k">
                        <mat-radio-group fxLayout="row wrap" fxLayoutGap="40px" [formControlName]="bff.personalData.type.k">
                            <mat-radio-button class="ob-radio-button inline" [value]="buyerType.guest">
                                <mat-label>{{'BUYERS.NOT_REGISTERED' | translate}}</mat-label>
                            </mat-radio-button>
                            <mat-radio-button class="ob-radio-button inline" [value]="buyerType.registered">
                                <mat-label>{{'BUYERS.REGISTERED' | translate}}</mat-label>
                            </mat-radio-button>
                        </mat-radio-group>
                    </mat-form-field>
                 </div>
                <!-- LANGUAGE -->
                <mat-form-field appearance="outline" class="ob-form-field field-with-label" fxFlex="100%"
                    fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)">
                    <mat-label>{{'FORMS.LABELS.LANGUAGE' | translate}}</mat-label>
                    <mat-select [placeholder]="'FORMS.SELECT.PLACE_HOLDER' | translate" [formControlName]="bff.personalData.language.k"
                        aria-label="language">
                        <mat-option *ngFor="let language of languages$ | async" [value]="language?.code">
                            {{language ? (( 'LANGUAGES.' + language.code ) | translate) : ''}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <!-- BIRTH DATE -->
                <mat-form-field fxFlex="140px" appearance="outline" class="ob-form-field field-with-label">
                    <mat-label>{{'BUYERS.BIRTHDATE' | translate}}</mat-label>
                    <input matInput [matDatepicker]="birthDateDP" [placeholder]="dateFormat"
                        [formControlName]="bff.personalData.birthDate.k" (focus)="birthDateDP.open()">
                    <button mat-icon-button matSuffix class="ob-button large no-hover-ripple"
                    (click)="$event.stopPropagation(); birthDateDP.open();">
                        <mat-icon>event</mat-icon>
                    </button>
                    <mat-datepicker #birthDateDP></mat-datepicker>
                </mat-form-field>
            </div>
        </mat-expansion-panel>
        <!-- ADDRESS -->
        <mat-expansion-panel expanded togglePosition="before" [formGroupName]="bff.location.k">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'BUYERS.ADDRESS' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <div fxLayout="row wrap" fxLayoutGap.gt-sm="40px">
                <!-- COUNTRY -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.COUNTRY' | translate}}</mat-label>
                    <mat-select [formControlName]="bff.location.country.k" [placeholder]="'FORMS.ACTIONS.SELECT' | translate">
                        <mat-option *ngFor="let item of (countries$ | async)" [value]="item.code">
                            {{item.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <!-- COUNTRY_SUBDIVISION -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.COUNTRY_SUBDIVISION' | translate}}</mat-label>
                    <mat-select [formControlName]="bff.location.countrySubdivision.k" [placeholder]="'FORMS.ACTIONS.SELECT' | translate">
                        <mat-option *ngFor="let item of (countrySubdivisions$ | async)" [value]="item.code">
                            {{item.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <!-- CITY -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.CITY' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'FORMS.LABELS.CITY' | translate" [formControlName]="bff.location.city.k">
                </mat-form-field>
                <!-- ZIP CODE -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.ZIPCODE' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'FORMS.LABELS.ZIPCODE' | translate"
                        [formControlName]="bff.location.zipCode.k">
                </mat-form-field>
                <!-- ADDRESS -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.ADDRESS' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'FORMS.LABELS.ADDRESS' | translate"
                        [formControlName]="bff.location.address.k">
                </mat-form-field>
            </div>
        </mat-expansion-panel>
        <!-- CONTACT DATA -->
        <mat-expansion-panel expanded togglePosition="before" [formGroupName]="bff.contact.k">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'BUYERS.CONTACT' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <div fxLayout="row wrap" fxLayoutGap.gt-sm="40px">
                <!-- EMAIL -->
                <mat-form-field fxFlex="100%" fxFlex.gt-sm="0 1 calc(50% - 40px)" fxFlex.gt-md="0 1 calc(33.3% - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.EMAIL' | translate}}</mat-label>
                    <input matInput type="text" [formControlName]="bff.contact.email.k">
                </mat-form-field>
                <!-- PHONE -->
                <mat-form-field fxFlex="0 1 calc(50% - 20px)" fxFlex.gt-sm="0 1 calc(200px - 40px)" appearance="outline"
                    class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.PHONE' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'FORMS.LABELS.PHONE' | translate" [formControlName]="bff.contact.fix.k">
                </mat-form-field>
                <mat-form-field fxFlex="0 1 calc(50% - 20px)" fxFlex.gt-sm="0 1 calc(200px - 40px)" fxFlexOffset.lt-md="40px"
                    appearance="outline" class="ob-form-field field-with-label">
                    <mat-label>{{'FORMS.LABELS.MOBILE_PHONE' | translate}}</mat-label>
                    <input matInput type="text" [placeholder]="'FORMS.LABELS.MOBILE_PHONE' | translate"
                        [formControlName]="bff.contact.mobile.k">
                </mat-form-field>
            </div>
        </mat-expansion-panel>
        <!-- NOTES -->
        <mat-expansion-panel expanded togglePosition="before">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'BUYERS.NOTES' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <div fxLayout="row wrap" fxLayoutGap.gt-sm="40px" fxFlex.gt-sm="0 1 calc(100% - 40px)">
                <mat-form-field fxFlex="100%" appearance="outline" class="ob-form-field field-with-label">
                    <textarea matInput class="notes-text-area" [placeholder]="'BUYERS.NOTES' | translate" [formControlName]="bff.notes.k">
                    </textarea>
                </mat-form-field>
            </div>
        </mat-expansion-panel>
    </form>
</app-form-container>
<div class="spinner-container" *ngIf="reqInProgress$ | async">
    <mat-spinner></mat-spinner>
</div>
