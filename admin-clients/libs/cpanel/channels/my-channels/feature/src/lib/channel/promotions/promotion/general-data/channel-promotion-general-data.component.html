<app-form-container sidebar [disabled]="!form.dirty || (loading$ | async)" (cancel)="cancel()" (save)="save()">
    <form [formGroup]="form">
        <!-- PROMOTION GENERAL INFO -->
        <mat-expansion-panel expanded togglePosition="before">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'CHANNELS.PROMOTIONS.GENERAL_INFO' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <div fxLayout="row wrap" class="promotion-form-section">
                <!-- PROMOTION NAME -->
                <mat-form-field id="name" fxFlex="100%" fxFlex.gt-md="50%" appearance="outline"
                    class="ob-form-field field-with-label name-form-field">
                    <mat-label>{{'FORMS.LABELS.NAME' | translate}}</mat-label>
                    <input formControlName="name" matInput [placeholder]="'FORMS.LABELS.NAME' | translate">
                    <mat-error [ob-form-errors]="form" field="name"></mat-error>
                </mat-form-field>
                <mat-form-field id="use-name-as-communication" hidden-outline fxFlex="100%">
                    <input hidden matInput>
                    <mat-checkbox formControlName="useNameForCommunication" color="primary">
                        <mat-label>
                            {{'CHANNELS.PROMOTIONS.USE_NAME_IN_COMMUNICATION' | translate}}
                        </mat-label>
                    </mat-checkbox>
                </mat-form-field>
            </div>
        </mat-expansion-panel>
        <!-- PROMOTION CHANNEL COMMUNICATION -->
        <mat-expansion-panel expanded togglePosition="before" class="without-body-padding">
            <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                <mat-panel-title>{{'CHANNELS.PROMOTIONS.COMMUNICATION' | translate}}
                </mat-panel-title>
            </mat-expansion-panel-header>
            <app-communication-text-content [form]="form" [restrictions]="fieldRestrictions"
                [languages$]="languages$">
            </app-communication-text-content>
        </mat-expansion-panel>
    </form>
    <div class="sidebar-container" slot="sidebar" fxLayout="column">
        <span class="sidebar-label">{{'CHANNELS.PROMOTIONS.USES' | translate}}</span>
        <span>{{(promotion$ | async)?.usage_limits.promotion_max.current || '0'}}</span>
    </div>
</app-form-container>
