<div class="flex flex-row items-center column-labels">
    @for (field of config().fields; track field.name; let isFirst = $first) {
        <span class="column-header-label">{{ field.label + (field.required ? ' *' : '') }}</span>
    }
</div>
<div class="flex flex-col gap-4" [formGroup]="credentialsForm">
    <div class="credentials-list flex flex-col gap-4">
        @for (credential of credentialsForm.controls; let i = $index; track credential) {
            <div class="credentials-item flex flex-row items-center" [formArrayName]="$index">
                @for (field of config().fields; track field.name; let isFirst = $first) {
                    @if (!isFirst) { <mat-divider /> }
                    <mat-form-field appearance="outline" class="ob-form-field inline-field" subscriptSizing="dynamic">
                        <input [formControlName]="field.name" matInput
                            [placeholder]="field.placeholder" [type]="field.type || 'text'"
                            autocomplete="off">
                    </mat-form-field>
                }
                <button mat-icon-button aria-label="Delete" class="ob-button xsmall delete-button"
                    (click)="delete(i)" [disabled]="credentialsForm.length <= 1 || credentialsForm.disabled">
                    <mat-icon>delete</mat-icon>
                </button>
            </div>
        }
    </div>
    @let maxReached = credentialsForm.length >= max();
    @let disabled = maxReached || credentialsForm.disabled;
    <!-- {{}}-->
    <a class="flex flex-row items-center gap-2 add-credential-button"
        [matTooltip]="maxReached ? ('CHANNELS.SERVER_TRACKING.MAX_CREDENTIALS_REACHED' | translate: { max: max() } ) : ''"
        (click)="add()" [class.disabled]="disabled">
        <button mat-icon-button aria-label="Add" class="ob-button mat-stroked-button small" [disabled]="disabled">
            <mat-icon>add</mat-icon>
        </button>
        <span>
            {{ 'CHANNELS.SERVER_TRACKING.ADD_CREDENTIAL' | translate }}
        </span>
    </a>
</div>