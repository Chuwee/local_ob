@if ($requestAccepted()) {
    <app-language-bar [languages]="$languageList()" [selected]="language$ | async"
    (changed)="changeLanguage($event)" class="sticky" />
    <app-form-container [hideActionBar]="!$showTemplates()" [formGroup]="form" (cancel)="cancel()" (save)="save()"
        [disabled]="!form.dirty" class="no-top-padding">
        <div class="details-container">
            @if ($showLinks() && (eventChannelLinks$ | async); as eventChannelLinks) {
                @if (eventChannelLinks.event_link) {
                    <div class="actions-bar flex flex-row justify-start items-center">
                        <div class="flex flex-row justify-start items-center">
                            <span class="copy-label">{{'EVENTS.CHANNEL.CHANNEL.CONTENT.EVENT_LINK_LABEL' | translate}}</span>
                            <span class="copy-link">{{eventChannelLinks?.event_link}}</span>
                            <app-copy-text [copyText]="eventChannelLinks?.event_link"
                                [copyOk]="'EVENTS.CHANNEL.CHANNEL.CONTENT.LINK_COPY_OK' | translate"
                                [copyKo]="'EVENTS.CHANNEL.CHANNEL.CONTENT.LINK_COPY_KO' | translate"
                                [copyTooltip]="'EVENTS.CHANNEL.CHANNEL.CONTENT.COPY_LINK' | translate" />
                        </div>
                        <div class="go-link">
                            <a mat-button aria-label="Go to link" class="ob-button medium" target="_blank"
                                href="{{eventChannelLinks?.event_link}}">
                                <span>{{'EVENTS.CHANNEL.CHANNEL.CONTENT.GO_TO_LINK' | translate}}</span>
                                <mat-icon iconPositionEnd>launch</mat-icon>
                            </a>
                        </div>
                    </div>
                }

                <div [class.no-event-link]="!eventChannelLinks.event_link">
                    <app-event-channel-sessions-link-list [eventId]="$eventChannel().event.id"
                        [channelId]="$eventChannel().channel.id" [language]="language$ | async" />
                </div>
                @if (editAttendantLink$ | async; as editAttendantLink) {
                    <mat-expansion-panel [togglePosition]="'before'">
                        <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                            <mat-panel-title>
                                {{'EVENTS.CHANNEL.CHANNEL.CONTENT.EDIT_ATTENDEES' | translate}}
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="flex flex-row items-center justify-start">
                            <span class="copy-link">{{editAttendantLink?.link}}</span>
                            <app-copy-text [copyText]="editAttendantLink?.link"
                                [copyOk]="'EVENTS.CHANNEL.CHANNEL.CONTENT.LINK_COPY_OK' | translate"
                                [copyKo]="'EVENTS.CHANNEL.CHANNEL.CONTENT.LINK_COPY_KO' | translate"
                                [copyTooltip]="'EVENTS.CHANNEL.CHANNEL.CONTENT.COPY_LINK' | translate" />
                            <div class="go-link">
                                <a mat-button class="ob-button medium" target="_blank" href="{{editAttendantLink?.link}}"
                                    aria-label="Go to link">
                                    <span>{{'EVENTS.CHANNEL.CHANNEL.CONTENT.GO_TO_LINK' | translate}}</span>
                                    <mat-icon>launch</mat-icon>
                                </a>
                            </div>
                        </div>
                    </mat-expansion-panel>
                }
            }
            <mat-expansion-panel expanded [togglePosition]="'before'">
                <mat-expansion-panel-header expandedHeight="*" collapsedHeight="*">
                    <mat-panel-title>
                        {{'EVENTS.CHANNEL.CHANNEL.CONTENT.TICKETS' | translate}}
                    </mat-panel-title>
                </mat-expansion-panel-header>
                @if ($showTemplates()) {
                    <div class="select-templates flex flex-row justify-start items-center">
                        <mat-form-field appearance="outline" class="ob-form-field inline-field field-with-label ticket-selection">
                            <mat-label class="template-label">{{'EVENTS.COMMUNICATION.TEMPLATE_PDF' | translate}}</mat-label>
                            <mat-select formControlName="venueTemplateId" class="flex flex-col">
                                @for (template of templates$ | async; track template.id) {
                                    <mat-option [value]="template.id" class="flex flex-row space-x-2">
                                        <span class="flex-auto" appEllipsify [matTooltip]="template.name">{{template.name}}</span>
                                    </mat-option>
                                }
                            </mat-select>
                        </mat-form-field>
                    </div>
                }
                <div class="flex flex-row justify-start items-center">
                    <span>{{'EVENTS.CHANNEL.CHANNEL.CONTENT.TICKETS_DESCRIPTION' | translate}}</span>
                    <div class="go-link">
                        <button mat-button class="ob-button medium" (click)="openTicketPreview()">
                            <mat-icon>visibility</mat-icon>
                            {{'ACTIONS.SEE_TICKET.BTN' | translate}}
                        </button>
                    </div>
                </div>
            </mat-expansion-panel>
        </div>
    </app-form-container>
} @else {
    <app-empty-state class="w-full"
        [title]="'EVENTS.CHANNEL.CHANNEL.CONTENT.REQUEST_NOT_ACCEPTED' | translate" />
}
@if (isLoading$ | async) {
    <div class="spinner-container">
        <mat-spinner />
    </div>
}
