<div class="dialog-msg-container">
    <div class="dialog-header-container" fxLayout="row" mat-dialog-title>
        <h2 fxFlex="100%" fxLayoutAlign="start end" class="secondary title">
            {{'USERS.MFA.ACTIONS.ACTIVATE' | translate}}
        </h2>
        <button mat-icon-button type="button" class="ob-button small" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div>
        <app-wizard-bar [steps]="['USERS.MFA.TITLES.ACTIVATE_STEP_PASS', 'USERS.MFA.TITLES.ACTIVATE_STEP_ENTER_CODE']"></app-wizard-bar>
    </div>
    <div [formGroup]="form" mat-dialog-content class="with-wizard-bar" fxLayout="column" fxLayoutGap="24px">

        @switch (currentStep$()) {

        @case (1) {
        <p>{{'USERS.MFA.FORMS.INFOS.ACTIVATE_PASS_HELP' | translate}}</p>

        <mat-form-field class="ob-form-field field-with-label tall" appearance="outline" fxFlex="1 1 100%">
            <mat-label>{{'LOGIN.PASSWORD' | translate}}</mat-label>
            <input matInput type="password" aria-label="password" formControlName="password" (keyup.enter)="setStep2()"
                autocomplete="password" name="password" [placeholder]="'LOGIN.PASSWORD' | translate">
        </mat-form-field>
        }

        @case (2) {
        <p>{{'USERS.MFA.FORMS.INFOS.ACTIVATE_ENTER_CODE_HELP' | translate}}</p>

        <mat-form-field class="ob-form-field field-with-label tall" appearance="outline" fxFlex="1 1 100%">
            <mat-label>{{'FORMS.LABELS.CODE' | translate}}</mat-label>
            <input matInput type="text" aria-label="code" formControlName="code" (keyup.enter)="save()"
                name="code" [placeholder]="'FORMS.LABELS.CODE' | translate">
        </mat-form-field>
        }

        }

    </div>

    <div mat-dialog-actions fxLayoutAlign="center center">
        <div fxFlex fxLayoutAlign="end">
            <div fxLayoutAlign="center center">
                <button type="button" mat-button class="ob-button" (click)="close()"
                    [disabled]="$isLoading()">
                    {{'FORMS.ACTIONS.CANCEL' | translate}}
                </button>
                <button mat-stroked-button color="tertiary" type="button" class="ob-button"
                    (click)="setStep1()" [disabled]="currentStep$() < 2 || ($isLoading())">
                    <mat-icon>arrow_back</mat-icon>
                    {{'FORMS.ACTIONS.PREVIOUS' | translate}}
                </button>
                @if (currentStep$() === 1) {
                <button mat-flat-button color="primary" type="button" class="ob-button"
                    [disabled]="$isLoading()" (click)="setStep2()">
                    {{'FORMS.ACTIONS.NEXT' | translate}}
                    <mat-icon iconPositionEnd>arrow_forward</mat-icon>
                    @if ($isLoading()) {
                    <div class="spinner-container">
                        <mat-spinner [diameter]="25"></mat-spinner>
                    </div>
                    }
                </button>
                }
                @if (currentStep$() > 1) {
                <button #saveBtn mat-flat-button color="primary" type="button" class="ob-button"
                    [disabled]="$isLoading()" (click)="save()">
                    {{'ACTIONS.ACTIVATE' | translate}}
                    @if ($isLoading()) {
                    <div class="spinner-container">
                        <mat-spinner [diameter]="25"></mat-spinner>
                    </div>
                    }
                </button>
                }
            </div>
        </div>
    </div>
</div>