<div class="dialog-msg-container flex flex-col flex-nowrap">
    <div mat-dialog-title class="select-channels-title">
        <h2 class="secondary title grow">{{'TITLES.SALES_SELECT_CHANNELS' | translate}}</h2>
        <button mat-icon-button type="button" class="ob-button small" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div mat-dialog-content class="filter-container">
        <div class="basis-full">
            <app-searchable-paginated-selection #selection class="event-channels-container"
                [placeholder]="'FORMS.SEARCH_CHANNEL_FIELD' | translate" (loadData)="loadChannelsList($event)" [pageSize]="pageSize"
                [form]="selectedForm" [data$]="channelsListData$" [metadata$]="channelsListMetadata$">
                <ng-template #selectionTemplate let-data="data" let-pageForm="pageForm"
                    let-selectionChanged="selectionChanged">
                    <div class="channels-list-container flex flex-row">
                        <app-selection-list class="boxed-options basis-full" [noPadding]="true" [data]="data"
                            [pageForm]="pageForm" [selectionChanged]="selectionChanged"
                            [disabledOptionPredicate]="shouldDisableChannel">
                            <ng-template #optionTemplate let-row>
                                <div class="flex flex-row justify-start items-center grow">
                                    <span class="card-title ellipsify-no-wrap flex-grow flex-shrink basis-0"
                                        appEllipsify [matTooltip]="row.name">
                                        {{row.name}}
                                    </span>
                                    @if (row.entity.logo) {
                                        <img [alt]="row.name" [src]="row.entity.logo" class="thumbnail" />
                                    } @else {
                                        <div class="thumbnail default flex justify-center items-center">
                                            <mat-icon>image</mat-icon>
                                        </div>
                                    }
                                </div>
                            </ng-template>
                        </app-selection-list>
                    </div>
                </ng-template>
            </app-searchable-paginated-selection>
        </div>
    </div>
    <div mat-dialog-actions class="flex justify-center items-center">
        <div class="footer-info flex flex-col justify-start">
            <span>{{ 'EVENTS.CHANNEL.SELECTED' | translate : ({canalesSeleccionados: ((channelsSelected$ | async))}) }}</span>
            @if (selectedForm.value?.length >= maxChannel) {
                <div class="max-reached-info flex flex-row justify-start items-center basis-full">
                    <mat-icon class="ob-icon xsmall info with-text">info</mat-icon>
                    <span>{{ 'EVENTS.CHANNEL.MAX_CHANNELS_REACHED' | translate }}</span>
                </div>
            }
        </div>
        <div class="flex flex-row flex-grow flex-shrink basis-0 justify-end">
            <div class="flex justify-center items-start">
                <button type="button" mat-button class="ob-button" (click)="close()" [disabled]="isLoadingOrSaving$ | async">
                    {{'FORMS.ACTIONS.CANCEL' | translate}}
                </button>
                <button mat-flat-button color="primary" type="button" class="ob-button" (click)="addChannels()"
                    [disabled]="(selectedForm.value?.length === 0) || (isLoadingOrSaving$ | async) || ((channelsSelected$ | async) > 10)">
                    {{'FORMS.ACTIONS.ADD' | translate}}
                </button>
            </div>
        </div>
    </div>
</div>
@if (isLoadingOrSaving$ | async) {
    <div class="spinner-container"><mat-spinner /></div>
}
