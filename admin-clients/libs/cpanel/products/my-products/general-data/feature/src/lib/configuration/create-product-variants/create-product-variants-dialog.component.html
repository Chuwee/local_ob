<div class="dialog-msg-container" fxLayout="column nowrap" fxFlex="100%">
    <div mat-dialog-title fxLayout="row">
        <h2 fxFlex="100%" class="secondary title">{{'PRODUCT.VARIANTS.ACTIONS.CREATE_VARIANTS' | translate}}</h2>
        <button mat-icon-button type="button" class="ob-button small" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <app-wizard-bar [steps]="steps" [enableNavigation]="true" (stepClick)="goToStep($event)"></app-wizard-bar>
    @switch ($currentStep()) {
        @case (0) {
            <app-product-attributes [maxSelection]="maxAttributesSelection"></app-product-attributes>
        }
        @case (1) {
            <app-product-attribute-values [maxSelection]="maxVariantsFromValuesCombination" [maxVariantsReached]="$maxVariantsReached()"
                action="CREATE" (currentValuesChanged)="currentValuesChanged($event)">
            </app-product-attribute-values>
        }
    }
    <div mat-dialog-actions fxLayoutAlign="space-between center">
        <div class="footer-info" fxLayout="column" fxLayoutAlign="start">
            @switch ($currentStep()) {
                @case (0) {
                    <span>{{('PRODUCT.VARIANTS.FORMS.INFOS.ATTRIBUTES_COUNT' | translate : {
                        current: $currentAttributes(), max: maxAttributesSelection
                    })}}</span>
                    @if ($currentAttributes() === 2) {
                        <div fxFlex="100%" fxLayout="row" fxLayoutAlign="start center">
                            <mat-icon class="ob-icon xxsmall info with-text">info</mat-icon>
                            <span class="info-message">
                                {{('PRODUCT.VARIANTS.FORMS.INFOS.MAX_ATTRIBUTES_REACHED' | translate : { max: maxAttributesSelection })}}
                            </span>
                        </div>
                    }
                }
                @case (1) {
                    <span>{{('PRODUCT.VARIANTS.FORMS.INFOS.VARIANTS_COUNT' | translate : {
                        current: $variantsToCreate(), max: maxVariantsFromValuesCombination
                    })}}</span>
                    @if ($maxVariantsReached()) {
                        <div fxFlex="100%" fxLayout="row" fxLayoutAlign="start center">
                            <mat-icon class="ob-icon xxsmall info with-text">info</mat-icon>
                            <span class="info-message">
                                {{('PRODUCT.VARIANTS.FORMS.INFOS.MAX_VARIANTS_REACHED' | translate : {
                                    max: maxVariantsFromValuesCombination })}}
                            </span>
                        </div>
                    }
                }
            }
        </div>
        <div fxLayoutAlign="end">
            <button mat-button type="button" class="ob-button" (click)="close()" [disabled]="isInProgress$ | async">
                {{'FORMS.ACTIONS.CANCEL' | translate}}
            </button>
            <button mat-stroked-button color="tertiary" type="button" class="ob-button" (click)="goToStep($currentStep() - 1)"
                [disabled]="$currentStep() === 0 || (isInProgress$ | async)">
                <mat-icon>arrow_back</mat-icon>
                {{'FORMS.ACTIONS.PREVIOUS' | translate}}
            </button>
            <button mat-flat-button color="primary" type="button" class="ob-button" (click)="nextStep()"
                [disabled]="(isInProgress$ | async) || $disableNextStepButton()">
                {{($currentStep() === steps.length - 1 ? 'FORMS.ACTIONS.CREATE' : 'FORMS.ACTIONS.NEXT') | translate}}
                @if ($currentStep() !== steps.length - 1) {
                    <mat-icon iconPositionEnd>arrow_forward</mat-icon>
                }
            </button>
        </div>
    </div>
</div>
@if (isInProgress$ | async) {
    <div class="spinner-container">
        <mat-spinner></mat-spinner>
    </div>
}