<div mat-dialog-content fxLayout="column" class="with-wizard-bar">
    <p>{{('PRODUCT.VARIANTS.FORMS.INFOS.CREATE_ATTRIBUTES_INFO' | translate : { max: $maxSelection() })}}</p>
    <div fxLayout="row wrap" fxLayoutGap="8px" class="new-attribute-container">
        <mat-form-field appearance="outline" class="ob-form-field inline-field" [class.cursor-not-allowed]="$currentAttributes() === 2"
            fxFlex="35%" [matTooltip]="'PRODUCT.VARIANTS.FORMS.INFOS.MAX_ATTRIBUTES_REACHED' | translate : { max: $maxSelection() }"
            [matTooltipDisabled]="$currentAttributes() !== 2">
            <input matInput aria-label="name" [formControl]="newProductAttribute"
                [placeholder]="'PRODUCT.VARIANTS.FORMS.LABELS.ATTRIBUTE_NAME' | translate">
        </mat-form-field>
        <div fxFlex="none">
            <button mat-stroked-button color="primary" type="button" class="ob-button medium add-button"
                [attr.aria-label]="'PRODUCT.VARIANTS.ACTIONS.CREATE_ATTRIBUTE' | translate"
                [disabled]="$currentAttributes() === 2 || !newProductAttribute.value"
                (click)="addNewAttribute()">
                <mat-icon>add</mat-icon>
                {{'PRODUCT.VARIANTS.ACTIONS.CREATE_ATTRIBUTE' | translate}}
            </button>
        </div>
    </div>
    <div [formGroup]="productAttributesForm" class="attribute-list-container">
        @if (productAttributes$ | async; as attributes) {
            <mat-list class="ob-list" role="list" cdkDropList [cdkDropListData]="attributes"
                (cdkDropListDropped)="onListDrop($event)"
                [cdkDropListSortingDisabled]="attributesList.invalid || attributes.length <= 1">
                @for (attribute of attributes; track attribute.attribute_id; let i = $index) {
                    <mat-list-item cdkDrag cdkDragLockAxis="y" cdkDragBoundary=".ob-list"
                        class="editable-item with-position" role="listitem">
                        <span class="ob-round-badge badge-list-position">
                            {{i + 1}}
                        </span>
                        <mat-icon class="drag-icon">
                            drag_indicator
                        </mat-icon>
                        <div fxFlex class="write-value">
                            <div fxFlex="65%">
                                <input #attributeInput type="text" [formControl]="attributesList.controls.at(i)"
                                    [class.invalid]="attributesList.at(i).invalid" (blur)="updateAttribute(i)"
                                    [placeholder]="'PRODUCT.VARIANTS.FORMS.LABELS.ATTRIBUTE_NAME' | translate"
                                    (mousedown)="$event.stopPropagation()">
                            </div>
                        </div>
                        <div class="delete-action">
                            <button type="button" mat-icon-button class="ob-button medium" aria-label="Delete product attribute"
                                (click)="deleteAttribute(attribute.attribute_id)">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </div>
                    </mat-list-item>
                }
            </mat-list>
        }
    </div>
</div>