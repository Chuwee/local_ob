<div class="payments-container">
    <mat-table class="ob-table order-detail-table dense-table" [dataSource]="payments">
        <ng-container matColumnDef="date">
            <mat-header-cell *matHeaderCellDef class="head-cell">
                {{'FORMS.LABELS.DATE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                {{row.date | dateTime : dateTimeFormats.shortDateTime}}
            </mat-cell>
            <mat-footer-cell *matFooterCellDef>
                {{'FORMS.LABELS.TOTAL' | translate}}
            </mat-footer-cell>
        </ng-container>
        <ng-container matColumnDef="method">
            <mat-header-cell *matHeaderCellDef class="head-cell">
                {{'FORMS.LABELS.PAYMENT_METHOD' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row; let i = index">
                @if(pgpPayments?.length && pgpPayments[i]) {
                    <span>
                        {{pgpPayments[i]['description']}}
                    </span>
                }
                @else {
                    <span>
                        @if(paymentDetailMethod) {
                            {{paymentDetailMethod}}
                        }
                        @else {
                            {{row.type === paymentType.voucher && voucherInfo?.group?.type === voucherType.seasonTicket
                            ? ('ORDER.PAYMENT.TYPE.BALANCE' | translate) : 'ORDER.PAYMENT.TYPE.' + row.type | translate}}
                        }
                        @if(row.type === (paymentType.creditCard || paymentType.other) && row.gateway) {
                            ({{row.gateway}})
                    }
                    </span>
                    }
            </mat-cell>
            <mat-footer-cell *matFooterCellDef />
        </ng-container>
        <ng-container matColumnDef="description">
            <mat-header-cell *matHeaderCellDef class="head-cell">
                {{'FORMS.LABELS.DESCRIPTION' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                @if(pgpSaleTransactionId) {
                    <span appEllipsify [matTooltip]="pgpSaleTransactionId" matTooltipClass="ob-tooltip-nowrap">
                        {{pgpSaleTransactionId}}
                    </span>
                }
                @else if (row.reference) {
                    <span>{{'ORDER.PAYMENT.REFERENCE' | translate: {numReference: row.reference} }}</span>
                }
            </mat-cell>
            <mat-footer-cell *matFooterCellDef />
        </ng-container>
        <ng-container matColumnDef="price">
            <mat-header-cell *matHeaderCellDef class="head-cell right">
                {{'FORMS.LABELS.PRICE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row" class="right">
                {{row.value | localCurrency: currency}}
            </mat-cell>
            <mat-footer-cell *matFooterCellDef class="right">
                {{paymentsTotalAmount | localCurrency: currency}}
            </mat-footer-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="paymentsColumns" class="dense-row" />
        <mat-row *matRowDef="let row; columns: paymentsColumns;" class="dense-row"
            [class.interactive-row]="row.type === paymentType.voucher && voucherInfo?.group?.id
                && voucherInfo?.group?.type !== voucherType.seasonTicket"
            (click)="$event.preventDefault(); goToVoucher(row)" />
        <mat-footer-row *matFooterRowDef="paymentsColumns" class="dense-row" />
    </mat-table>
</div>