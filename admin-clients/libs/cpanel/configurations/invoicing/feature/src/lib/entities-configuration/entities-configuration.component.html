<div fxFlex="0 1 100%" fxLayout="column">
    <app-form-container [formGroup]="form" (cancel)="cancel()" (save)="save()" [disabled]="!form.dirty" layout="main"
        class="no-top-padding">
        <div class="form-details-area" fxFlex="grow" fxLayoutAlign="center">
            <div class="details-container content-wrapper" fxLayout="column" fxFlex="0 1 1280px">

                <form [formGroup]="configsArray" fxLayout="column" fxLayoutGap="10px">
                    <div fxLayout="row wrap">
                        <div fxFlex="0 1 100%" fxLayout="column" fxLayoutAlign="end end">
                            <button type="button" mat-stroked-button class="ob-button medium add" color="primary"
                                (click)="openNewConfigDialog()">
                                <mat-icon>add</mat-icon>
                                {{'INVOICING.ENTITIES_CONFIGURATION.NEW' | translate }}
                            </button>
                        </div>
                    </div>


                    <div class="heading-container" fxLayout="row" fxLayoutAlign="space-between center">
                        <div fxFlex.xs="100%" fxFlex="50%" fxLayoutAlign="start center">
                            <app-search-input [placeholder]="'INVOICING.ENTITIES_CONFIGURATION.INFOS.SEARCH' | translate"
                                class="search-field"
                                fxFlex="100%">
                            </app-search-input>
                        </div>
                    </div>

                    <mat-table class="ob-table" [dataSource]="configs$ | async" [trackBy]="trackByFn"
                        matSort matSortActive="name" matSortDirection="asc" matSortDisableClear>
                        <ng-container matColumnDef="name">
                            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                                {{'FORMS.LABELS.ENTITY' | translate}}
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row" fxLayoutAlign="start center">
                                <span>{{row.entity.name}}</span>
                            </mat-cell>
                        </ng-container>
                        @for (column of inputColumns; track column) {
                            <ng-container [matColumnDef]="column">
                                <mat-header-cell *matHeaderCellDef class="head-cell input-column">
                                    {{('INVOICING.ENTITIES_CONFIGURATION.FIELD_' + column.toUpperCase()) | translate}}
                                </mat-header-cell>
                                <mat-cell *matCellDef="let row" fxLayoutAlign="start center"
                                    class="editable-cell">
                                    <div fxFlex="100%" class="write-value">
                                        <mat-form-field appearance="outline" class="ob-form-field">
                                            <input matInput [formControl]="row.ctrl.get(column)" [placeholder]="0" type="number">
                                        </mat-form-field>
                                    </div>
                                </mat-cell>
                            </ng-container>
                        }
                        <mat-header-row *matHeaderRowDef="columns; sticky: true" class="dense-row"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: columns" class="dense-row hoverable-row">
                        </mat-row>
                    </mat-table>
                    <mat-error *ngIf="configsArray.hasError('minGreaterThanMax')">
                        {{'INVOICING.ENTITIES_CONFIGURATION.RANGE_ERROR' | translate}}
                    </mat-error>
                </form>

            </div>
        </div>
    </app-form-container>
</div>
<div class="spinner-container" *ngIf="reqInProgress$ | async">
    <mat-spinner></mat-spinner>
</div>