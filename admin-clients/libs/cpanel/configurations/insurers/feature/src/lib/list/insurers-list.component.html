@let insurersMetadata = insurersMetadata$ | async;
@let isLoading = isLoading$ | async;
<div class="list-container flex flex-col basis-full">
    <div class="heading-container without-overflow-hidden flex flex-row flex-wrap justify-between items-start">
        <div>
            <h1 class="secondary mat-headline-3">{{'TITLES.INSURERS' | translate}}</h1>
        </div>
        <div class="actions-container flex flex-wrap justify-end">
            <div class="filter-container flex-none">
                <button mat-stroked-button color="primary" type="button" class="ob-button medium add-button"
                    [attr.aria-label]="'OPERATOR.NEW_BTN' | translate" [matTooltip]="'OPERATOR.NEW_BTN' | translate"
                    (click)="openNewInsurerDialog()">
                    <mat-icon>add</mat-icon>
                    {{'INSURER.NEW_BTN' | translate}}
                </button>
            </div>
        </div>
    </div>
    <div class="heading-container without-overflow-hidden flex flex-row justify-end">
        <div>
            @if (insurersMetadata) {
                <p class="page-summary" [innerHTML]="'PAGINATION.PAGE_SUMMARY' | translate: insurersMetadata"></p>
            }
            <!-- TO DO: Add filters when backend ready -->
            <!-- <app-paginator [length]="insurersMetadata?.total" [pageSize]="insurersPageSize" /> -->
        </div>
    </div>
    <div class="heading-container heading-divider">
        <mat-divider />
    </div>
    @if (isLoading) {
        <div class="spinner-container">
            <mat-spinner />
        </div>
    }
    <mat-table class="ob-table" [dataSource]="(insurers$ | async)" [trackBy]="trackByFn" [attr.aria-label]="'TITLES.INSURERS' | translate"
        [ngClass]="{'not-touchable': (isHandsetOrTablet$ | async) !== true}">
        <ng-container matColumnDef="name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">{{'INSURERS.FORMS.LABELS.NAME' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.name}}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="tax_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">{{'INSURERS.FORMS.LABELS.TAX_NAME' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.tax_name}}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="operator">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">{{'INSURERS.FORMS.LABELS.OPERATOR' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.operator?.name}}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="contact_email">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">{{'INSURERS.FORMS.LABELS.EMAIL' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.contact_email}}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="phone">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">{{'INSURERS.FORMS.LABELS.PHONE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.phone}}</mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" />
        <mat-row *matRowDef="let row; columns: displayedColumns;" class="interactive-row"
            [routerLink]="[row.id, 'general-data']" />
    </mat-table>
    @if (insurersMetadata?.total === 0 && !$hasAppliedFilters() && !isLoading) {
        <app-empty-state class="flex basis-full" [title]="'INSURERS.EMPTY_LIST_TITLE' | translate" />
    }
</div>
