<div class="list-container" fxFlex="0 1 100%" fxLayout="column">
    <div class="heading-container" fxLayout="row wrap" fxLayoutAlign="space-between start">
        <div>
            <h1 class="secondary mat-headline-3">
                {{'TITLES.CANDIDATES_BLACKLIST' | translate}}
            </h1>
        </div>
        <div class="actions-container" fxFlex="auto" fxLayout="row wrap" fxLayoutAlign="end center">
            <app-supplier-selection-button [supplier]="selectedSupplierName$ | async"
                (valueChanged)="changeSelectedSupplier($event)" />
            <button mat-icon-button class="ob-button medium" aria-label="refresh" (click)="refresh()">
                <mat-icon>autorenew</mat-icon>
            </button>
        </div>
    </div>
    <div class="heading-container" fxLayout="row" fxLayoutAlign="space-between center">
        <div fxFlex="80%" fxLayoutGap="20px" fxLayoutAlign="start center">
            <div class="filter-container" fxFlex="none" data-test="filterBtn">
                <app-popover appFilter>
                    <app-blacklisted-matchings-list-filter #filterContent />
                </app-popover>
            </div>
            <div class="search-field" fxFlex="100%">
                <app-search-input [placeholder]="'FORMS.SEARCH.MATCHINGS_LIST' | translate" />
            </div>
        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px">
            <p *ngIf="blacklistedMatchingsMetadata$ | async as matchingsMetadata" class="page-summary"
                [innerHTML]="'PAGINATION.PAGE_SUMMARY' | translate: matchingsMetadata">
                <!-- eslint-disable-next-line @angular-eslint/template/prefer-self-closing-tags -->
            </p>
            <app-paginator [length]="(blacklistedMatchingsMetadata$ | async)?.total" [pageSize]="matchingsPageSize" />
        </div>
    </div>
    <div class="heading-container">
        <app-chips appFilter />
    </div>
    @if (loading$ | async) {
        <div class="spinner-container">
            <mat-spinner />
        </div>
    }
    <mat-table class="ob-table" [dataSource]="blacklistedMatchings$ | async" matSort [matSortActive]="initSortCol"
        [matSortDirection]="initSortDir" matSortDisableClear [attr.aria-label]="'TITLES.MATCHINGS.MATCHINGS_LIST_TITLE' | translate"
        [class.not-touchable]="(isHandsetOrTablet$ | async) !== true">
        <ng-container matColumnDef="supplier_event_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.EVENT_NAME' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.supplier_event?.name" matTooltipClass="ob-tooltip-nowrap">
                    {{row.supplier_event?.name}}
                </span>
                <app-copy-text *ngIf="row.supplier_event?.name" [copyText]="row.supplier_event?.name"
                    class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="supplier_id">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.EVENT_ID' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.supplier_event?.id" matTooltipClass="ob-tooltip-nowrap">
                    {{row.supplier_event?.id}}
                </span>
                <app-copy-text *ngIf="row.supplier_event?.id" [copyText]="row.supplier_event?.id"
                    class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="supplier_venue_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.VENUE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.supplier_event?.venue?.name" matTooltipClass="ob-tooltip-nowrap">
                    {{row.supplier_event?.venue?.name}}
                </span>
                <app-copy-text *ngIf="row.supplier_event?.venue?.name" [copyText]="row.supplier_event?.venue?.name"
                    class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="supplier_date">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.EVENT_DATE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">{{row.supplier_event?.date | dateTime : dateTimeFormats.shortDateTime}}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="supplier_country_code">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.COUNTRY_CODE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                {{row.supplier_event?.venue?.country_code ?? '-'}}
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="shi_event_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.SHI_EVENT_NAME' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.shi_event?.name" matTooltipClass="ob-tooltip-nowrap">
                    {{row.shi_event?.name ?? '-'}}
                </span>
                <app-copy-text *ngIf="row.shi_event?.name" [copyText]="row.shi_event?.name" class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="shi_id">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.SHI_EVENT_ID' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.shi_event?.id" matTooltipClass="ob-tooltip-nowrap">
                    {{row.shi_event?.id ?? '-'}}
                </span>
                <app-copy-text *ngIf="row.shi_event?.id" [copyText]="row.shi_event?.id" class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="shi_venue_name">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.SHI_VENUE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <span appEllipsify [matTooltip]="row.shi_event?.venue?.name" matTooltipClass="ob-tooltip-nowrap">
                    {{row.shi_event?.venue?.name ?? '-'}}
                </span>
                <app-copy-text *ngIf="row.shi_event?.venue?.name" [copyText]="row.shi_event?.venue?.name"
                    class="copy-button" />
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="shi_date">
            <mat-header-cell *matHeaderCellDef mat-sort-header class="head-cell">
                {{'MATCHINGS.SHI_EVENT_DATE' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                {{row.shi_event?.date ? (row.shi_event?.date | dateTime : dateTimeFormats.shortDateTime) : '-' }}
            </mat-cell>
        </ng-container>
        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
            <mat-header-cell *matHeaderCellDef class="head-cell" [class.float-actions-cell]="(isHandsetOrTablet$ | async) !== true" />
            <mat-cell *matCellDef="let row" [class.float-actions-cell]="(isHandsetOrTablet$ | async) !== true">
                <div class="action-buttons" (click)="$event.stopPropagation()">
                    <button mat-icon-button [attr.aria-label]="'CANDIDATES_BLACKLIST.ACTIONS.UNBLOCK_CANDIDATE' | translate"
                        class="ob-button medium" (click)="openUnblockCandidateDialog(row)" *ngIf="hasWritePermissions$ | async">
                        <mat-icon>add_circle_outline</mat-icon>
                    </button>
                </div>
            </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" />
        <mat-row *matRowDef="let row; columns: displayedColumns;" class="interactive-row" matRipple />
    </mat-table>
    <div class="context-notification-container" *ngIf="(blacklistedMatchingsMetadata$ | async)?.total === 0" fxFlex="0 50 100%"
        fxLayout="row" fxLayoutAlign="center start">
        <app-context-notification *ngIf="(blacklistedMatchingsMetadata$ | async)?.total === 0"
            class="ob-context-notification" contextType="info" fxFlex.gt-sm="600px" fxFlex="80%" fxLayoutAlign="center start">
            <div *ngIf="emptyListWithWordAndFilters$ | async else normalEmptyList"
                fxLayout="column" fxLayoutAlign="start center" fxLayoutGap="20px">
                <p>{{'LIST.EMPTY_LIST_WITH_KEYWORD' | translate}}</p>
                <button mat-stroked-button color="primary" type="button" class="ob-button medium"
                    [attr.aria-label]="'LIST.REMOVE_FILTERS' | translate"
                    (click)="removeFilters()">
                    {{'LIST.REMOVE_FILTERS_BTN' | translate}}
                </button>
            </div>
            <ng-template #normalEmptyList>
                <p>{{'LIST.EMPTY' | translate}}</p>
            </ng-template>
        </app-context-notification>
    </div>
</div>