<app-form-container [formGroup]="form" (cancel)="cancel()" (save)="save()" layout="main"
    [disabled]="(formChanged$ | async) === false" [hideActionBar]="(hasWritePermissions$ | async) === false">
    <div>{{'MATCHER_SETTINGS.FORMS.INFOS.DELIVERY' | translate}}</div>
    @if((isLoading$ | async) === false) {
        <mat-checkbox color="primary" formControlName="enabled" class="checkbox-container">
            {{ 'MATCHER_SETTINGS.FORMS.INFOS.DELIVERY_ENABLED'| translate }}
        </mat-checkbox>
    }
    <div class="setting-container">
        <div fxLayoutAlign="end start" fxLayoutGap="10px" class="add-button-container">
            <button mat-stroked-button color="primary" type="button" class="ob-button medium add-button" (click)="addElement()"
                [disabled]="(hasWritePermissions$ | async) === false">
                <mat-icon>add</mat-icon>
                {{'MATCHER_SETTINGS.ACTIONS.ADD_NEW_EMAIL' | translate}}
            </button>
        </div>
        <div>
            <div fxLayout="row" fxLayoutAlign="space-between center" class="filters">
                <div fxFlex fxLayoutAlign="start center" fxLayoutGap="8px">
                    <ng-content select="[slot='filter']" />
                    <app-search-input [placeholder]="'MATCHER_SETTINGS.FORMS.INFOS.SEARCH_BY_EMAIL' | translate"
                        (valueChanged)="changeSearchText($event)" fxFlex="0 1 600px" class="search-input" />
                </div>
                <div class="paginator above">
                    <mat-paginator hidePageSize fxFlex="0 0 auto" class="with-range-label transparent"
                        [pageIndex]="emailsPage$ | async" [pageSize]="pageLimit"
                        [length]="(filteredEmails$ | async)?.length" (page)="changePage($event)" />
                </div>
            </div>
            @if ((isLoading$ | async) === false) {
                <div class="paginated-list">
                    <mat-list class="ob-list small-rows">
                        <div class="list-header">
                            <span>{{'FORMS.LABELS.EMAIL' | translate}}</span>
                        </div>
                        <div class="list-items-container" [class.interactive]="hasWritePermissions$ | async">
                            @for (c of (pagedEmails$ | async); track c) {
                                <mat-list-item
                                    [class.hoverable-item]="hasWritePermissions$ | async">
                                    <div fxLayout="row" fxLayoutAlign="space-between center" fxFlex="100%">
                                        <div fxLayout="row" fxLayoutAlign="start center">
                                            <span appEllipsify class="o-hidden-text-row" [matTooltip]="c">{{c}}</span>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="end center">
                                            <div class="actions-container" fxLayout="row" fxLayoutAlign="end center">
                                                @if(hasWritePermissions$ | async){
                                                    <button mat-icon-button aria-label="delete" class="ob-button xsmall"
                                                        [matTooltip]="'MATCHER_SETTINGS.ACTIONS.DELETE_EMAIL' | translate"
                                                        (click)="deleteElement(c)">
                                                        <mat-icon>delete</mat-icon>
                                                    </button>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </mat-list-item>
                            }
                        </div>
                    </mat-list>
                    @if ((filteredEmails$ | async)?.length === 0) {
                        <app-empty-state-tiny fxFlex [title]="'FORMS.SELECT.NO_RESULTS' | translate" />
                    }
                </div>
            }
        </div>
    </div>
</app-form-container>
@if(isLoading$ | async){
    <div class="spinner-container">
        <mat-spinner />
    </div>
}