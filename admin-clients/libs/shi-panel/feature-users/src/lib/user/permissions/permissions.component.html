<app-form-container layout="main" [formGroup]="form" (cancel)="cancel()" (save)="save()"
    [disabled]="!form.dirty || (isInProgress$ | async) || !canEditUser" class="overflow-y-auto">
    <div slot="outside" *ngIf="canEditUser">
        <!-- User status -->
        <div class="user-status" fxLayout="row" fxLayoutAlign="center">
            <div fxFlex="0 1 1280px" fxLayoutAlign="end center" fxLayoutGap="10px">
                <div class="ob-label">
                    {{'USER.STATUS' | translate}}
                </div>
                <div class="user-status-select" fxFlex="220px">
                    <mat-form-field fxFlex appearance="outline" class="ob-form-field ob-form-field-outline inline-field thin-select-field">
                        <mat-select formControlName="userStatus">
                            <mat-select-trigger>
                                <span [ngClass]="['status-dot', form.get('userStatus').value?.toLowerCase() || '']">
                                </span>
                                <span>{{'USER.STATUS_OPTS.' + form.get('userStatus').value | translate}}</span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let status of userStatusList" [value]="status">
                                <span>{{'USER.STATUS_OPTS.' + status | translate}}</span>
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
        </div>
        <mat-divider></mat-divider>
    </div>
    <div *ngIf="availableUserPermissions" class="user-permissions-container" fxLayout="row">
        <!-- User permissions -->
        <div class="permissions-list-container" fxLayout="column">
            <div class="user-permissions-header permissions-list-header">
                <h3 class="section-title">{{'USER.USER_PERMISSIONS_TITLE' | translate | uppercase}}</h3>
            </div>
            <mat-button-toggle-group vertical [formControl]="selectedPermission" class="ob-outline-button-group">
                <mat-button-toggle *ngFor="let permission of availableUserPermissions" [value]="permission">
                    <mat-checkbox [formControl]="form.get(['permissionsGroup', permission.id])" color="primary">
                    </mat-checkbox>
                    {{permission.name | translate}}
                </mat-button-toggle>
            </mat-button-toggle-group>
        </div>
        <!-- User permission description -->
        <div fxFlex class="permission-description-container">
            <div fxLayout="column" *ngIf="selectedPermission.value as permissionSelected">
                <div class="user-permissions-header">
                    <h3 class="section-title">{{'USER.PERMISSION_DESCRIPTION_TITLE' | translate | uppercase}}</h3>
                </div>
                <div fxLayout="column">
                    <!-- Description -->
                    <div>
                        <p>{{'USER.PERMISSION_DESCRIPTIONS.' + permissionSelected.id.toUpperCase() | translate}}</p>
                    </div>
                    <!-- Permissions options list -->
                    <div *ngIf="permissionDefaultDescriptions[permissionSelected?.id.toUpperCase()].length">
                        <span>{{'USER.PERMISSION_DESCRIPTIONS_TITLE' | translate}}</span>
                        <ul>
                            <li *ngFor="let permissionDescription of permissionDefaultDescriptions[permissionSelected?.id.toUpperCase()]">
                                {{'USER.PERMISSION_DESCRIPTIONS.'+ permissionDescription | translate}}
                            </li>
                        </ul>
                    </div>
                    <!-- Extra information list -->
                    <div *ngIf="permissionExtraInformations[permissionSelected?.id.toUpperCase()]">
                        <span>{{'USER.PERMISSION_EXTRA_INFOS_TITLE' | translate}}</span>
                        <ul>
                            <li *ngFor="let permissionDescription of permissionExtraInformations[permissionSelected?.id.toUpperCase()]">
                                {{'USER.PERMISSION_EXTRA_INFOS.'+ permissionDescription | translate}}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</app-form-container>
<div class="spinner-container" *ngIf="isInProgress$ | async">
    <mat-spinner></mat-spinner>
</div>
