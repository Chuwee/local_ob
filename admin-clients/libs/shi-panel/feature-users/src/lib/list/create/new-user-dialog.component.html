<div class="dialog-msg-container" fxLayout="column nowrap" fxFlex="100%">
    <div mat-dialog-title fxFlex="auto" fxLayout="row" fxFlexAlign="start">
        <h2 fxFlex="100%" class="secondary title">{{'TITLES.NEW_USER' | translate}}</h2>
        <button mat-icon-button type="button" class="ob-button small" (click)="close(null)">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div mat-dialog-content fxLayout="column" fxLayoutAlign="start stretch">
        <form [formGroup]="form" fxLayout="column" fxLayoutAlign="start stretch">
            <!-- Name -->
            <mat-form-field appearance="outline" class="ob-form-field">
                <mat-label>{{'USERS.NAME' | translate}}</mat-label>
                <input matInput aria-label="name" [placeholder]="'USERS.NAME' | translate" formControlName="name">
                <mat-error [ob-form-errors]="form" field="name" />
            </mat-form-field>
            <!-- Surname -->
            <mat-form-field appearance="outline" class="ob-form-field">
                <mat-label>{{'USERS.SURNAME' | translate}}</mat-label>
                <input matInput aria-label="last_name" [placeholder]="'USERS.SURNAME' | translate"
                    formControlName="last_name">
                <mat-error [ob-form-errors]="form" field="last_name" />
            </mat-form-field>
            <!-- Email -->
            <mat-form-field appearance="outline" class="ob-form-field">
                <mat-label>{{'USERS.EMAIL' | translate}}</mat-label>
                <input matInput aria-label="email" [placeholder]="'USERS.EMAIL' | translate" formControlName="email">
                <mat-error [ob-form-errors]="form" field="email" />
            </mat-form-field>
            <!-- Role -->
            <mat-form-field appearance="outline" class="ob-form-field" *ngIf="(isOwnerUser$ | async) else isNotOwner">
                <mat-label>{{'USERS.ROLE' | translate}}</mat-label>
                <mat-select [placeholder]="'FORMS.SELECT.PLACE_HOLDER' | translate"
                    formControlName="role">
                    <mat-option *ngFor="let userRole of userRoles" [value]="userRole.id">
                        {{ userRole.name | translate }}
                    </mat-option>
                </mat-select>
                <mat-error [ob-form-errors]="form" field="role" />
            </mat-form-field>
            <ng-template #isNotOwner>
                <div fxFlex="100%" fxFlex.gt-xs="0 1 calc(50% - 24px)"
                    fxFlex.gt-sm="0 1 calc(33.3% - 24px)" class="details-non-editable-field ob-form-field" fxLayout="column">
                    <span class="field-label">{{'USER.ROLE' | translate}}</span>
                    <span>{{'USERS.ROLE_OPTS.USER' | translate}}</span>
                </div>
            </ng-template>
        </form>
    </div>
    <div mat-dialog-actions fxLayoutAlign="end">
        <button mat-button type="button" class="ob-button" [disabled]="isInProgress$ | async" (click)="close(null)">
            {{'FORMS.ACTIONS.CANCEL' | translate}}
        </button>
        <button mat-flat-button color="primary" type="button" class="ob-button" [disabled]="(isInProgress$ | async)"
            (click)="createUser()">
            {{'FORMS.ACTIONS.CREATE' | translate}}
        </button>
    </div>
</div>
<div class="spinner-container" *ngIf="isInProgress$ | async">
    <mat-spinner />
</div>